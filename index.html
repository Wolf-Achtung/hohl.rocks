<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>hohl.rocks â€” Wolf Hohl Â· KI-Manager</title>

  <!-- Favicon: Data-URI (verhindert 404) -->
  <link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="/>

  <style>
    html,body{height:100%;margin:0;background:#0a1118;color:#eaf2ff;font:500 16px/1.45 ui-sans-serif,system-ui}
    .stage{position:fixed;inset:0;overflow:hidden}
    #bg-video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:brightness(1) contrast(1.05)}
    #shape-layer{position:absolute;inset:0;pointer-events:auto}

    /* Chat-Dock */
    .chat-dock{position:fixed;right:22px;bottom:22px;z-index:40;background:rgba(12,16,22,.72);
      border:1px solid rgba(255,255,255,.14);backdrop-filter:blur(10px);padding:10px;border-radius:18px;display:flex;gap:8px;align-items:center}
    .chat-dock input{width:min(48vw,360px);max-width:68vw;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.16);
      color:#eaf2ff;border-radius:999px;padding:10px 14px;outline:none}
    .chat-dock button{background:#1b66ff;border:0;color:#fff;border-radius:999px;padding:9px 12px;cursor:pointer}
    .chat-dock .ghost{background:rgba(255,255,255,.10);border:1px solid rgba(255,255,255,.18);color:#eaf2ff}

    /* Antwortfeld */
    #chat-output{position:fixed;right:22px;bottom:92px;width:min(640px,88vw);max-height:min(58vh,460px);overflow:auto;
      background:rgba(12,16,22,.62);border:1px solid rgba(255,255,255,.12);backdrop-filter:blur(10px);border-radius:18px;padding:12px;display:none;z-index:42}
    #chat-output.show{display:block}
    .bubble-row{margin:8px 0;display:flex}
    .bubble-row.user .b-inner{margin-left:auto;background:rgba(255,255,255,.08)}
    .bubble-row.assistant .b-inner{margin-right:auto;background:rgba(27,102,255,.13)}
    .b-inner{padding:10px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.16)}

    .privacy-slot{position:fixed;left:14px;bottom:14px;z-index:34}

    /* (Legacy) HÃ¶he â€“ darf bleiben, stÃ¶rt nicht */
    .ticker{height:48px}
    @media (max-width:880px){.ticker{height:42px}}
  </style>
</head>
<body>
  <main class="stage" aria-label="Highway-Video mit organischen Neon-Shapes">
    <video id="bg-video" autoplay playsinline loop muted>
      <source src="/videos/desert_drive.mp4" type="video/mp4" />
    </video>
    <div id="shape-layer"></div>
  </main>

  <!-- Antwortbereich + Chat-Dock -->
  <div id="chat-output" aria-live="polite"></div>
  <div class="chat-dock">
    <input id="chat-input" type="text" placeholder="Frage stellenâ€¦ (KI, EU)"/>
    <button id="photo-btn" class="ghost" title="Foto nutzen">Foto</button>
    <button id="chat-send">Senden</button>
  </div>

  <div class="privacy-slot" id="privacy-slot"></div>

  <script>
    // Backend + Systemprompt
    window.HOHLROCKS_CHAT_BASE = 'https://hohlrocks-production.up.railway.app';
    window.WOLF_SYSTEM_PROMPT = [
      "Du antwortest im Namen von Wolf Hohl â€“ TÃœV-zertifizierter KI-Manager.",
      "Ton: seriÃ¶s, prÃ¤gnant, deutsch, winter-klar, freundlich.",
      "Erstantwort maximal 3 SÃ¤tze. Wo sinnvoll: 1 kurzes Beispiel, 1 pragmatischer nÃ¤chster Schritt.",
      "Beziehe dich â€“ wenn passend â€“ auf Wolfs Erfahrung (30 Jahre Marketing/Kommunikation, Trailer, >50 Mio Umsatz) und Rolle als KI-Manager.",
      "Keine Buzzword-Orgel. Falls unsicher: kurz Risiko/Trade-off erwÃ¤hnen."
    ].join(" ");
  </script>

  <!-- Shapes -->
  <link rel="stylesheet" href="/hero-shapes.css?v=sp2">
  <script src="/hero-shapes.js?v=sp2"></script>

  <!-- Analytics -->
  <script src="/analytics-lite.js?v=1"></script>

  <!-- Ticker-Inhalte (nur Items) -->
  <script src="/ticker-items.js?v=gc3"></script>

  <!-- Chat-Client -->
  <script src="/js/chatbox-stream.js?v=chat4"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      if (window.ChatDock && ChatDock.initChatDock){
        ChatDock.initChatDock({
          inputSel:'#chat-input',
          buttonSel:'#chat-send',
          systemPrompt: window.WOLF_SYSTEM_PROMPT,
          model: 'gpt-4o-mini'
        });
      }
    });
  </script>

  <!-- Variety + Spotlight + Foto-Flows -->
  <script src="/variety-engine.js?v=1"></script>
  <script src="/spotlight-card.js?v=1"></script>
  <script src="/micro-demos.js?v=1"></script>
  <script src="/photo-flows.js?v=1"></script>
  <script src="/style-switcher.js?v=1"></script>

  <!-- Motorsound (ein Autostart genÃ¼gt) -->
  <script src="/js/harley-lite.js?v=3"></script>
  <script src="/harley-lite-autostart.js?v=1"></script>

  <!-- SINGLE-ANSWER MODE + TICKER NO-OVERLAP + REMOVE TONE CHIPS (robust) -->
  <script>
  (function(){
    'use strict';

    const ANSWER_SEL = '.spotlight-card, #chat-output, .answer-overlay, .answer-marquee, .chat-answer, .chat-output';
    const TONE_MATCH = ['einfach','normal','nerdy'];

    // Antwort-Card immer Ã¼ber Ticker
    const css = `
      ${ANSWER_SEL} { position: relative; z-index: 9999 !important; }
      .ticker-wrap { position: fixed; left:24px; right:24px; z-index: 320 !important; pointer-events:auto; }
      .ticker { position:relative; overflow:hidden; height:48px; pointer-events:none;
                padding-right: var(--safeR, 340px);
                -webkit-mask-image:linear-gradient(90deg,transparent 0,black 8%,black 92%,transparent 100%);
                        mask-image:linear-gradient(90deg,transparent 0,black 8%,black 92%,transparent 100%); }
      .ticker-track { position:absolute; display:inline-flex; gap:14px; white-space:nowrap; will-change:transform;
                      animation:ticker-move var(--dur,140s) linear infinite; transform:translateZ(0); }
      .ticker-track.paused{ animation-play-state: paused; }
      .ticker a { display:inline-block; padding:10px 16px; border-radius:999px; text-decoration:none; pointer-events:auto;
                  color:#eaf2ff; background:rgba(20,28,36,.64); border:1px solid rgba(255,255,255,.16); backdrop-filter:blur(6px); }
      .ticker a:hover{ filter:brightness(1.08); }
      @keyframes ticker-move{ from{ transform:translateX(100%) } to{ transform:translateX(-110%) } }
      @media (max-width:880px){ .ticker-wrap{left:12px; right:12px} .ticker{height:42px} .ticker a{padding:8px 12px} }
      /* Chips entfernen */
      .tone-variants, .tone-chip, .tone-easy, .tone-normal, .tone-nerdy { display:none !important; }
    `;
    const style = document.createElement('style'); style.textContent = css; document.head.appendChild(style);

    // Helpers
    const $  = (s, r=document)=> r.querySelector(s);
    const $$ = (s, r=document)=> Array.from(r.querySelectorAll(s));

    // Nur die aktuelle Q/A sichtbar halten (alles alte weg)
    function singleAnswerMode(){
      const out = $('#chat-output');
      if (!out) return;
      // beim Senden: komplett leeren, dann zeigt ChatDock nur die aktuelle Q/A
      window.addEventListener('chat:send', ()=>{ out.innerHTML=''; out.classList.add('show'); });
      // Safety: bei Done max. die letzten 3 Bubble-Nodes behalten (Frage, Antwort, evtl. Fortsetzung)
      window.addEventListener('chat:done', ()=>{
        const rows = $$('.bubble-row', out);
        if (rows.length > 3) rows.slice(0, rows.length-3).forEach(n=>n.remove());
      });
    }

    // Tone-Chips (Text-basiert) entfernen â€“ auch wenn sie dynamisch kommen
    function removeToneChips(root=document){
      const candidates = $$('.tone-variants, .tone-chip, .tone-easy, .tone-normal, .tone-nerdy, button, .chip, .badge, .tag, [role="button"]', root);
      for (const el of candidates) {
        const t = (el.textContent||'').trim().toLowerCase();
        if (TONE_MATCH.includes(t)) el.remove();
      }
    }

    // Ticker bauen (falls kein externes ticker.js aktiv ist)
    function ensureTicker(){
      if ($('.ticker-wrap')) return;
      const wrap = document.createElement('div'); wrap.className='ticker-wrap';
      const inner= document.createElement('div'); inner.className='ticker';
      const track= document.createElement('div'); track.className='ticker-track';
      inner.appendChild(track); wrap.appendChild(inner); document.body.appendChild(wrap);

      const ITEMS = (Array.isArray(window.__TICKER_ITEMS) && window.__TICKER_ITEMS.length)
        ? window.__TICKER_ITEMS
        : [
            {label:'Ãœberrasch mich ðŸ¤¯', prompt:'Zeig mir etwas Unerwartetes, das KI heute schon gut kann â€“ in 3 SÃ¤tzen, mit kleinem Beispiel.'},
            {label:'Mini-Story (5 WÃ¶rter)', prompt:'Erzeuge eine spannende Mini-Story mit genau 5 WÃ¶rtern. Danach ein kurzer Titel.'},
            {label:'Haiku zur Fahrt', prompt:'Schreibe ein kurzes Haiku Ã¼ber eine nÃ¤chtliche Highway-Fahrt. Ton: ruhig, prÃ¤zise.'}
          ];

      function sendNow(text){
        try{ if (window.ChatDock?.send) { ChatDock.send(text); return; } }catch(_){}
        const i=$('#chat-input'), b=$('#chat-send');
        if(i){ i.value=text; i.dispatchEvent(new KeyboardEvent('keydown',{key:'Enter',code:'Enter',which:13,keyCode:13,bubbles:true})); }
        else { b?.click(); }
      }
      function addChip(lbl, prm, prev){
        const a=document.createElement('a'); a.href='#'; a.textContent=lbl; if(prev) a.title=prev;
        a.addEventListener('click', ev=>{ ev.preventDefault(); track.classList.add('paused'); sendNow(prm); });
        track.appendChild(a);
      }
      ITEMS.forEach(it=>addChip(it.label,it.prompt,it.preview));

      // Endlos auffÃ¼llen
      function topUp(){
        const vw=Math.max(320,window.innerWidth); let guard=20;
        while(track.scrollWidth<3*vw && guard-->0) ITEMS.forEach(it=>addChip(it.label,it.prompt,it.preview));
      }
      topUp();

      // sehr ruhige Geschwindigkeit
      const SPEED_PX_S = 16;
      const setDuration=()=>{ const vw=Math.max(320,window.innerWidth), px=track.scrollWidth+vw;
        const dur=Math.max(60, Math.min(260, px/SPEED_PX_S)); track.style.setProperty('--dur', dur.toFixed(1)+'s'); };
      setDuration();

      // Position & Layer
      function chatRect(){ const el=$('.chat-dock'); return el?el.getBoundingClientRect():null; }
      function ansRect(){  const el=$(ANSWER_SEL);  return el?el.getBoundingClientRect():null; }
      function fixBottom(){
        const wrapEl = wrap, innerEl = inner;
        const chat = chatRect(); const ans = ansRect(); const tickH = innerEl.getBoundingClientRect().height || 48;
        let bottom = chat ? (window.innerHeight - chat.top) + 12 : 76;              // Ã¼ber Chat
        if (ans){ const underAns = Math.max(12, window.innerHeight - ans.bottom - 12 - tickH); bottom = Math.min(bottom, underAns); }
        wrapEl.style.bottom = Math.max(12, bottom) + 'px';
        const safe = chat ? Math.ceil(chat.width + 24) : 340; innerEl.style.setProperty('--safeR', safe + 'px');
        // z-index unter Antwort halten
        const zi = ans ? parseInt(getComputedStyle($(ANSWER_SEL)).zIndex || '1000', 10) : 320;
        wrapEl.style.zIndex = String(Math.min(zi - 5, 600));
      }
      fixBottom();

      window.addEventListener('resize', ()=>{ topUp(); setDuration(); fixBottom(); }, {passive:true});
      window.addEventListener('chat:send', ()=>{ track.classList.add('paused'); fixBottom(); });
      window.addEventListener('chat:done', ()=>{ track.classList.remove('paused'); fixBottom(); });
      setInterval(()=> track.classList.remove('paused'), 30000);
    }

    // Init
    singleAnswerMode();
    removeToneChips();
    ensureTicker();

    // Auf DOM-Ã„nderungen reagieren (neue Antworten/Chips)
    const mo = new MutationObserver((muts)=>{
      for (const m of muts) m.addedNodes && m.addedNodes.forEach(n=>{ if(n.nodeType===1) removeToneChips(n); });
      // nur letzte Q/A behalten
      const out = document.getElementById('chat-output');
      if (out) {
        const rows = Array.from(out.querySelectorAll('.bubble-row'));
        if (rows.length > 3) rows.slice(0, rows.length-3).forEach(n=>n.remove());
      }
      // Ticker unten halten (falls extern gebaut wurde)
      const wrap = document.querySelector('.ticker-wrap');
      if (wrap) {
        const evt = new Event('resize'); window.dispatchEvent(evt);
      }
    });
    mo.observe(document.body, {childList:true, subtree:true});
  })();
  </script>
<!-- WOLF TICKER BOOT-RESCUE â€” erzwingt Start nach 5â€“7s, ruhig, ohne Ãœberlappung -->
<script>
(function(){
  'use strict';

  const ANSWER_SEL = '.spotlight-card, #chat-output, .answer-overlay, .answer-marquee, .chat-answer, .chat-output';

  function cssOnce(){
    if (document.getElementById('wolf-ticker-css')) return;
    const style = document.createElement('style'); style.id='wolf-ticker-css';
    style.textContent = `
      .ticker-wrap{position:fixed;left:24px;right:24px;z-index:320;pointer-events:auto}
      .ticker{position:relative;overflow:hidden;height:48px;pointer-events:none;
        padding-right:var(--safeR,340px);
        -webkit-mask-image:linear-gradient(90deg,transparent 0,black 8%,black 92%,transparent 100%);
                mask-image:linear-gradient(90deg,transparent 0,black 8%,black 92%,transparent 100%)}
      .ticker-track{position:absolute;display:inline-flex;gap:14px;white-space:nowrap;will-change:transform;
        animation:ticker-move var(--dur,140s) linear infinite;transform:translateZ(0)}
      .ticker-track.paused{animation-play-state:paused}
      .ticker a{display:inline-block;padding:10px 16px;border-radius:999px;text-decoration:none;pointer-events:auto;
        color:#eaf2ff;background:rgba(20,28,36,.64);border:1px solid rgba(255,255,255,.16);backdrop-filter:blur(6px)}
      .ticker a:hover{filter:brightness(1.08)}
      @keyframes ticker-move{from{transform:translateX(100%)}to{transform:translateX(-110%)}}
      @media (max-width:880px){.ticker-wrap{left:12px;right:12px}.ticker{height:42px}.ticker a{padding:8px 12px}}
      ${ANSWER_SEL}{position:relative;z-index:9999!important}
    `;
    document.head.appendChild(style);
  }

  function buildItems(){
    if (Array.isArray(window.__TICKER_ITEMS) && window.__TICKER_ITEMS.length) return window.__TICKER_ITEMS;
    return [
      {label:'Ãœberrasch mich ðŸ¤¯', prompt:'Zeig mir etwas Unerwartetes, das KI heute schon gut kann â€“ in 3 SÃ¤tzen, mit kleinem Beispiel.'},
      {label:'Mini-Story (5 WÃ¶rter)', prompt:'Erzeuge eine spannende Mini-Story mit genau 5 WÃ¶rtern. Danach ein kurzer Titel.'},
      {label:'Haiku zur Fahrt', prompt:'Schreibe ein kurzes Haiku Ã¼ber eine nÃ¤chtliche Highway-Fahrt. Ton: ruhig, prÃ¤zise.'}
    ];
  }

  function sendNow(text){
    try{ if (window.ChatDock?.send){ ChatDock.send(text); return; } }catch(_){}
    const i=document.querySelector('#chat-input'), b=document.querySelector('#chat-send');
    if(i){ i.value=text; i.dispatchEvent(new KeyboardEvent('keydown',{key:'Enter',code:'Enter',which:13,keyCode:13,bubbles:true})); }
    else { b?.click(); }
  }

  function mountTicker(){
    cssOnce();
    // bestehende, defekte Instanzen entfernen
    document.querySelectorAll('.ticker-wrap').forEach(el=>el.remove());

    const wrap=document.createElement('div'); wrap.className='ticker-wrap';
    const inner=document.createElement('div'); inner.className='ticker';
    const track=document.createElement('div'); track.className='ticker-track';
    inner.appendChild(track); wrap.appendChild(inner); document.body.appendChild(wrap);

    const items=buildItems();
    function addChip(lbl,prm){
      const a=document.createElement('a'); a.href='#'; a.textContent=lbl;
      a.addEventListener('click',ev=>{ ev.preventDefault(); track.classList.add('paused'); sendNow(prm); });
      track.appendChild(a);
    }
    items.forEach(it=>addChip(it.label,it.prompt));
    // auffÃ¼llen bis lang genug
    const vw=Math.max(320,window.innerWidth); let guard=20;
    while(track.scrollWidth<3*vw && guard-->0) items.forEach(it=>addChip(it.label,it.prompt));

    // sehr ruhig
    const SPEED_PX_S=16;
    const setDur=()=>{ const px=track.scrollWidth+Math.max(320,window.innerWidth);
      const dur=Math.max(60,Math.min(260,px/SPEED_PX_S)); track.style.setProperty('--dur',dur.toFixed(1)+'s'); };
    setDur();

    function chatRect(){ const el=document.querySelector('.chat-dock'); return el?el.getBoundingClientRect():null; }
    function ansRect(){  const el=document.querySelector(ANSWER_SEL); return el?el.getBoundingClientRect():null; }
    function fixBottom(){
      const chat=chatRect(), ans=ansRect(), tickH=inner.getBoundingClientRect().height||48;
      let bottom = chat ? (window.innerHeight - chat.top) + 12 : 76;
      if(ans){ const underAns=Math.max(12, window.innerHeight - ans.bottom - 12 - tickH); bottom=Math.min(bottom, underAns); }
      wrap.style.bottom = Math.max(12,bottom)+'px';
      inner.style.setProperty('--safeR', (chat?Math.ceil(chat.width+24):340)+'px');
      // z unter Antwort
      const zi = ans ? parseInt(getComputedStyle(ans).zIndex||'1000',10) : 320;
      wrap.style.zIndex = String(Math.min(zi-5, 600));
    }
    fixBottom();

    window.addEventListener('resize',()=>{ setDur(); fixBottom(); }, {passive:true});
    window.addEventListener('chat:send',()=>{ track.classList.add('paused'); fixBottom(); });
    window.addEventListener('chat:done',()=>{ track.classList.remove('paused'); fixBottom(); });

    // kleine Debug-API
    window.WolfTicker = {
      status(){ const td=getComputedStyle(track).animationDuration; return {chips:track.querySelectorAll('a').length,duration:td,bottom:wrap.style.bottom}; },
      faster(){ const d=parseFloat(getComputedStyle(track).animationDuration)||120; track.style.setProperty('--dur',Math.max(20,d*0.85)+'s'); },
      slower(){ const d=parseFloat(getComputedStyle(track).animationDuration)||120; track.style.setProperty('--dur',d*1.15+'s'); }
    };
  }

  function isRunning(){
    const track=document.querySelector('.ticker-track');
    if(!track) return false;
    const chips = track.querySelectorAll('a').length;
    const dur = parseFloat(getComputedStyle(track).animationDuration||'0');
    const paused = getComputedStyle(track).animationPlayState==='paused' || track.classList.contains('paused');
    return chips>0 && dur>10 && !paused;
  }

  // -> Starte Rettung nach 5.5s (stellbar: 7000 fÃ¼r 7s)
  function boot(){
    if (!isRunning()) mountTicker();
  }
  if (document.readyState==='complete') {
    setTimeout(boot, 5500);
  } else {
    window.addEventListener('load', ()=> setTimeout(boot, 5500), {once:true});
  }

  // Safety: alle 20s prÃ¼fen â€“ falls etwas stoppt, neu aufbauen
  setInterval(()=>{ if(!isRunning()) mountTicker(); }, 20000);
})();
</script>

</body>
</html>
